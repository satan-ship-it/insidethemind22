<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Methods of Enquiry in Psychology</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active, .nav-link:hover {
            color: #C084FC;
            border-bottom-color: #C084FC;
        }
        .card {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
                        0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .method-card.active {
            background-color: #E9D5FF;
            border-color: #C084FC;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 500px;
            }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="text-2xl font-bold text-purple-600">Psychological Enquiry</div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#introduction" class="nav-link active">Introduction</a>
                    <a href="#methods" class="nav-link">Research Methods</a>
                    <a href="#comparison" class="nav-link">Comparison</a>
                    <a href="#ethics" class="nav-link">Data & Ethics</a>
                </div>
                <div class="md:hidden">
                    <label for="mobile-nav" class="sr-only">Navigate</label>
                    <select id="mobile-nav" class="bg-gray-200 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-purple-500 focus:border-purple-500 block w-full p-2.5">
                        <option value="#introduction">Introduction</option>
                        <option value="#methods">Research Methods</option>
                        <option value="#comparison">Comparison</option>
                        <option value="#ethics">Data & Ethics</option>
                    </select>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12">
        <!-- Sections unchanged (introduction, methods, comparison, ethics) -->
        <!-- ... keep all content from your original file here ... -->
    </main>

    <footer class="bg-gray-800 text-white mt-20">
        <div class="container mx-auto px-6 py-4 text-center">
            <p>An Interactive Guide to Methods of Enquiry in Psychology.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- (methodsData code unchanged) ---

            const methodDetailsContainer = document.getElementById('method-details-container');
            const methodPlaceholder = document.getElementById('method-placeholder');
            const methodDetails = document.getElementById('method-details');
            const methodButtons = document.querySelectorAll('.method-card');

            methodButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const methodKey = button.dataset.method;
                    const data = methodsData[methodKey];

                    methodButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    let typesHtml = data.types.map(t => `<li class="mb-2"><strong class="text-purple-700">${t.name}:</strong> ${t.desc}</li>`).join('');
                    let advantagesHtml = data.advantages.map(adv => `<li class="flex items-start"><span class="text-green-500 mr-2">✓</span><span>${adv}</span></li>`).join('');
                    let limitationsHtml = data.limitations.map(lim => `<li class="flex items-start"><span class="text-red-500 mr-2">✗</span><span>${lim}</span></li>`).join('');

                    methodDetails.innerHTML = `
                        <div class="w-full">
                            <div class="flex items-center mb-4">
                                <span class="text-5xl mr-4">${data.icon}</span>
                                <h3 class="text-3xl font-bold text-gray-800">${data.title}</h3>
                            </div>
                            <p class="mb-6">${data.description}</p>
                            <div class="mb-6">
                                <h4 class="font-semibold text-lg mb-2 text-purple-800">Types & Variations</h4>
                                <ul class="list-none pl-0 text-sm">${typesHtml}</ul>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-semibold text-lg mb-2 text-green-700">Advantages</h4>
                                    <ul class="space-y-1 text-sm">${advantagesHtml}</ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-lg mb-2 text-red-700">Limitations</h4>
                                    <ul class="space-y-1 text-sm">${limitationsHtml}</ul>
                                </div>
                            </div>
                        </div>
                    `;

                    methodPlaceholder.classList.add('hidden');
                    methodDetails.classList.remove('hidden');
                });
            });

            // --- Chart.js comparison chart ---
            const ctx = document.getElementById('comparisonChart').getContext('2d');
            let comparisonChart;

            function createOrUpdateChart(metric) {
                const metricData = comparisonData.metrics[metric];

                if (comparisonChart) {
                    comparisonChart.data.datasets[0].data = metricData.data;
                    comparisonChart.data.datasets[0].label = metricData.label;
                    comparisonChart.update();
                } else {
                    comparisonChart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: comparisonData.labels,
                            datasets: [{
                                label: metricData.label,
                                data: metricData.data,
                                backgroundColor: [
                                    'rgba(192, 132, 252, 0.6)',
                                    'rgba(129, 140, 248, 0.6)',
                                    'rgba(96, 165, 250, 0.6)',
                                    'rgba(52, 211, 153, 0.6)',
                                    'rgba(251, 191, 36, 0.6)',
                                    'rgba(248, 113, 113, 0.6)'
                                ],
                                borderColor: [
                                    'rgba(192, 132, 252, 1)',
                                    'rgba(129, 140, 248, 1)',
                                    'rgba(96, 165, 250, 1)',
                                    'rgba(52, 211, 153, 1)',
                                    'rgba(251, 191, 36, 1)',
                                    'rgba(248, 113, 113, 1)'
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    beginAtZero: true,
                                    max: 5,
                                    ticks: {
                                        stepSize: 1,
                                        callback: function(value) {
                                            const labels = ['N/A', 'Very Low', 'Low', 'Moderate', 'High', 'Very High'];
                                            return labels[Math.round(value)] ?? value;
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top',
                                },
                                tooltip: { enabled: true }
                            }
                        }
                    });
                }
            }

            const metricSelector = document.getElementById('comparison-metric');
            metricSelector.addEventListener('change', (e) => {
                createOrUpdateChart(e.target.value);
            });
            createOrUpdateChart('causality');

            // --- IntersectionObserver fix ---
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => link.classList.remove('active'));
                        const activeLink = document.querySelector(`.nav-link[href="#${entry.target.id}"]`);
                        if (activeLink) activeLink.classList.add('active');
                    }
                });
            }, { rootMargin: '-50% 0px -50% 0px', threshold: 0 });

            sections.forEach(section => observer.observe(section));

            // --- Mobile navigation fix ---
            const mobileNav = document.getElementById('mobile-nav');
            mobileNav.addEventListener('change', (e) => {
                const target = document.querySelector(e.target.value);
                if (target) target.scrollIntoView({ behavior: 'smooth' });
            });
        });
    </script>
</body>
</html>
